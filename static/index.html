<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="cache-control" content="no-cache">
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="0">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link rel="shortcut icon" href="img/kurento.png" type="image/png"/>
    <link rel="stylesheet" href="bower_components/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="bower_components/demo-console/index.css">
    <link rel="stylesheet" href="bower_components/ekko-lightbox/dist/ekko-lightbox.min.css">
    <link rel="stylesheet" href="css/kurento.css">
    <script src="./bower_components/adapter.js/adapter.js"></script>
    <script src="bower_components/jquery/dist/jquery.min.js"></script>
    <script src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="bower_components/demo-console/index.js"></script>
    <script src="bower_components/ekko-lightbox/dist/ekko-lightbox.min.js"></script>
    <script src="bower_components/kurento-utils/js/kurento-utils.js"></script>
    <script src="bower_components/kurento-utils/js/kurento-utils.js"></script>
    <script src="bower_components/kurento-jsonrpc/js/kurento-jsonrpc.js"></script>
    <!--<script src="./js/EventEmitter.js"></script>-->
    <!--<script src="./js/KurentoRoom.js"></script>-->
    <title>Kurento Tutorial 3: Video Call 1 to N with WebRTC</title>
</head>
<body>
<p>test</p>

<div class="container-fluid">
    <div class="row">
        <div class="col-md-3" data-webrtc-presenterId="1">
            <div class="row">
                <!--<div class="videoSmall pull-left">-->
                <!--<video id="video_1" autoplay width="240px" height="180px" poster="img/webrtc.png"></video>-->
                <!--</div>-->
                <div class="col-md-4 pull-right">
                    <a id="joinRoom" href="#" class="btn btn-success">
                        joinRoom
                    </a>
                    <a id="signal" href="#" class="btn btn-success">
                        signal
                    </a>
                    <a id="join" href="#" class="btn btn-success">
                        join
                    </a>
                </div>
            </div>
            <div class="row">
                <div id="console_1" class="console democonsole">
                    <ul id="console_list_1"></ul>
                </div>
            </div>
        </div>
    </div>
    <div id="viewers" class="row">
    </div>
</div>
<script src="./js/socket.io.js"></script>
<script>
    //    var room, roomName = 'testRoom', userName = 'testUser', kurento = undefined;
    //    var roomOptions = {room: roomName, user: userName}
    //    var io = require('socket.io')
    //    $(document).ready(function () {
    var path = '/'//ws://' + location.host
    console.log(path)
    var room = 'roomname'//location.pathname
    var sender = Math.round(Math.random() * 999999999) + 999999999;
    var socket;
    io(path).emit('new-channel', {sender: sender, channel: room});
    $('#joinRoom').click(function () {
//        var socket = new WebSocket('ws://' + location.host);
        socket = io(path + room);
        socket.channel = room;
        socket.on('connect', function (s) {
//            console.log(socket)
            console.log('connected %s to room %s', sender, room)
//        room
            socket.emit('message', {username: 'eric', live: true})
            //        socket.on('event', function (data) {
            socket.on('room-joined', function (data) {
                console.log('Joined response')
                console.log(data)
            })
            socket.on('message', function (m) {
                console.log('message')
                console.log(m)
            });

            socket.on('user-left', function () {
                console.log('disconnect from socket')
            });
        });

        $('#signal').click(function () {
            socket.emit('signaling', {})
        })
    });

</script>

</body>
</html>